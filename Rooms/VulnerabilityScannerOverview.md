| [Home](../README.md) | [Cyber Security 101](../README.md#cyber-security-101) | **Vulnerability Scanner Overview** |

# Vulnerability Scanner Overview

## Contents
- [What Are Vulnerabilities?](#what-are-vulnerabilities)
- [Vulnerability Scanning](#vulnerability-scanning)
- [Tools for Vulnerability Scanning](#tools-for-vulnerability-scanning)
- [CVE & CVSS](#cve-cvss)
- [OpenVAS](#openvas)
- [Practical Exercise](#practical-exercise)



## ðŸ“˜What Are Vulnerabilities?

Vulnerability, a weakness in something. Maybe a mug has a hairline crack. Been there for years and one day you have a hot cup of tea down you. The cup was compromised.

A vulnerability is a weakness in the security of a system, many vulnerabilties are low risk, however a low risk could become a critical if found exploitable. 

It is our responsibilities to ensure we patch these vulnerabiltiies as soon as possible to reduce the risk to the environment.


### â“ Question

> What is the process of fixing the vulnerabilities called?

#### ðŸ§ª Process

I've always used the name `Remediation` for fixing vulnerabilities. 

Oh, now I have started reading the intro, I can see we're supposed to use `Patching`. ðŸ˜„

Trying this as the answer

#### âœ… Answer

- `Patching` âœ…



## ðŸ“˜Vulnerability Scanning

When performing a vulnerability scan we are essentially looking at all the potentially open ports on a machine then trying to identify if any services that are linked to those open ports are suseptable to a vulnerability. 

Scanning a host once is not enough, we need to reglarly scan every device on the network regulalry to ensure compliance. New software or services could be installed or even new vulnerabilities discovered for an existing service.

When it comes to scanning there are two types **Authenticated** and **Unauthenticated** scans, below we see a comparison

|                       Authenticated                        |                       Unauthenticated                       |
|------------------------------------------------------------|-------------------------------------------------------------|
| An authenticated account must be used                      | Has no internal access, must be scanned Externally (via IP) |
| Identifies vunerabilities exploitable with physical access | Identifies vulnerabilities exploitable via the network      |
| Greater visibility of installed config and installed apps  | Less invasive and simpler to implement                      |
| **Example**: Scan internal DB with credentials             | **Example**: Scan website for exploits                      |


And what about the location of the scan taking place. Well, we have **internal** and **external** scans. Again, some key points below

|    Internal                                                |    External                                                 |
|------------------------------------------------------------|-------------------------------------------------------------|
| Scans from within the network                              | Scans external to the network                               |
| Focuses on exploits within the network                     | Focuses on external exploits                                |
| Useful for discovering potential pivot exploits            | Identifies attack vectors                                   |


### â“ Question 1

> Which type of vulnerability scans require the credentials of the target host?

#### ðŸ§ª Process

We would want the credentials of a host in order to perform an _internal_ _`authenticated`_ scan.

Trying this as the answer

#### âœ… Answer

- `authenticated` âœ…


### â“ Question 2

> Which type of vulnerability scan focuses on identifying the vulnerabilities that can be exploited from outside the network?

#### ðŸ§ª Process

Outside == `External`

Trying this as the answer

#### âœ… Answer

- `External` âœ…



## ðŸ“˜Tools for Vulnerability Scanning

There are lots of scanners out there, lets take a look at some of the common ones

### Nessus

![image](https://github.com/user-attachments/assets/ff221b72-f131-4673-be99-ba39bd1146c0)

Originally open source back in '98 it was qxquired by Tenable in 2005 when it was changed to proprietary software. Widely used by large org's. Has extensive scanning apability. A free version exists but is very limited in capabilty compared to the commercial versions.

### Qualys

![image](https://github.com/user-attachments/assets/1ef8db6c-2c62-4a1c-91fb-a244d5c53d42)

Developed in '99 as a subscription based VMS. In addition to continuious scanning it also has asset management and compliance checks. Also cloud based which is a bonus for infrastrucutre.


### Nexpose

![image](https://github.com/user-attachments/assets/2b1d1756-9359-452e-80ed-3e66e0f9a69d)

Developed by _Rapid7_ in '05. Also subscription based, and performns continious scanning. Provides rislk scores based on asset value and impact.  Both on prem and cloud deployment.


### OpenVAS (Open Vulnerability Assessment System)

![image](https://github.com/user-attachments/assets/4d69b491-7f92-4796-84c1-8a5980f493f9)

Another Open-Source VAS. Detail reports, all vulns discovered and scores. 

### â“ Question 1

> Is Nessus currently an open-source vulnerability scanner? (Yea/Nay)

#### ðŸ§ª Process

`Nay`, it was reclassified as a proprietary software back in 2005

Trying this as the answer

#### âœ… Answer

- `Nay` âœ…


### â“ Question 2

> Which company developed the Nexpose vulnerability scanner?

#### ðŸ§ª Process

Nexpose was developed by _`Rapid7`_.

Trying this as the answer

#### âœ… Answer

- `Rapid7` âœ…


### â“ Question 3

> What is the name of the open-source vulnerability scanner developed by Greenbone Security?

#### ðŸ§ª Process

Greenbone ovvers the `OpenVAS`

Trying this as the answer

#### âœ… Answer

- `OpenVAS` âœ…



## ðŸ“˜CVE & CVSS

### CVE

CVE stands for **Common Vulnerabilties and exposures**, it is like a ticket. The MITRE Corporation created the framework to record the progress of vulnerabilities.

The CVE number has the following structure.

`CVE - YYYY - ####`

The CVE prefix just tells you it is a CVE, it is instantly recognisable. The year represents the year of discovery, whilst the remaining digits represnet the sequence in sequential order.


### CVSS

The CVSS stands for **Common Vulnerabilitiy Scoring System**

| CVSS Score (Range)  | Severity Levels |
|---------------------|-----------------|
| 0.0 -  3.9          | Low             |
| 4.0 -  6.9          | Medium          |
| 7.0 -  8.9          | High            |
| 9.0 - 10.0          | Critical        |



### â“ Question 1

> CVE stands for?

#### ðŸ§ª Process

Oh, oh, oh, I know this `Common Vulnerabilities and Exposures`.

Trying this as the answer

#### âœ… Answer

- `Common Vulnerabilities and Exposures` âœ…


### â“ Question 2

> Which organization developed CVE?

#### ðŸ§ª Process

The `MITRE Corporation`

Trying this as the answer

#### âœ… Answer

- `MITRE Corporation` âœ…


### â“ Question 3

> What would be the severity level of the vulnerability with a score of 5.3?

#### ðŸ§ª Process

5.3 falls within `4.0 - 6.9` which would be `Medium`

Trying this as the answer

#### âœ… Answer

- `Medium` âœ…



## ðŸ“˜OpenVAS

### Installation

Apparently OpenVAS can be tricky to install due to dependencies, I'd like challange that at some point, but in the mean time let's go with it.


THM recommends installing OpenVAS as a docker container. First we'd need to install Docker

```Shell
sudo apt install docker.io
```

Then once installed we can obtain the docker container from [immauss](https://immauss.github.io/openvas/) by issuing the following command

```Shell
sudo docker run -d -p 443:443 --name openvas immauss/openvas
```

Once downloaded and started we should be able to reach the container via `https://127.0.0.1`.

![image](https://github.com/user-attachments/assets/3e12778d-0be3-43c4-b656-e22def6caab0)


### Performing a Vulnerability Scan

Once in  the dashbaord click **New Task**
![image](https://github.com/user-attachments/assets/a79d5751-99d3-48bd-b344-59a1564e25f0)

Give it a **Name** and click **Scan Targets**
![image](https://github.com/user-attachments/assets/541d6fb6-a74e-4fe9-8692-5c82dc3808fe)

Give the target a **Name** and give it an **IP Address**, click **Create** to save the target.
![image](https://github.com/user-attachments/assets/926d95f1-f497-43f9-bdef-66f21ab3521c)

Choose a **Scan Config** and click **Create**
![image](https://github.com/user-attachments/assets/d8a3765d-7870-4512-8259-71c0a1efaa62)

Finally click **Initiate** on the scan you just created.
![image](https://github.com/user-attachments/assets/084530a9-9848-4923-ad6f-23381271346b)


After some time scan will complete, if you are lucky you will be VulnFree. But in reality that is unlikely.

Click the task to review the report
![image](https://github.com/user-attachments/assets/6ed8e17e-3897-419c-881a-093ee5d5f95f)

In this example we can see there are 13 results. Click the **13** to review the results
![image](https://github.com/user-attachments/assets/3d8c0d6a-e6d1-49c0-bd88-1746ef55d7d6)

**Note**: The machine will have a CVSS of the higest CVSS found on the machine. If you ahve 100 low vulns and 1 critical, you'll have a CVSS score of Critical or 9.1 for example.

### â“ Question 1

> What is the IP address of the machine scanned in this task?

#### ðŸ§ª Process

The target we added was `10.10.154.44`.

Trying this as the answer

#### âœ… Answer

- `10.10.154.44` âœ…


### â“ Question 2

> How many vulnerabilities were discovered on this host?

#### ðŸ§ª Process

There where `10` log entries, `2` Low, and `1` Medium. So `13.

Trying this as the answer

#### âœ… Answer

- `13` âœ…



## ðŸ“˜Practical Exercise

### Our Scenario
> A reputable firm conducted a vulnerability scan on a server (10.10.86.239) on its network that stores critical information.
>
> This activity was intended to enhance the organizationâ€™s security posture. The security team conducted the activity using the OpenVAS vulnerability scanner, and the vulnerability scan report was placed on the desktop.
>
> You are an information security engineer working for that firm. You are tasked with reviewing this report.
>
> You can simply open the report placed on the desktop or perform the vulnerability scan again to answer the questions below. OpenVAS is pre-installed on the host to which you are given access.


### â“ Question 1

> What is the score of the single high-severity vulnerability found in the scan?

#### ðŸ§ª Process

The report is saved on the desk top using the html format. So it will open in our favorite browser, firefox.

So straight away, I see the first entry in the report:
![image](https://github.com/user-attachments/assets/91dfcb83-40dd-4462-96fc-aabba5471aab)

That is a `10.0`

Trying that as the answer


#### âœ… Answer

- `10` âœ…


### â“ Question 2

> What is the solution suggested by OpenVAS for this vulnerability?

#### ðŸ§ª Process

We can see that the vuln result is default credentialss, so a misconfiguration. At least this kind of vuln is fairly striaght forward to remediate.

I need to find the polished answer...

**Solution**: `Change the password of the mentioned account(s).`


#### âœ… Answer

- `Change the password of the mentioned account(s).` âœ…

Honestly, I would like to have seen a more indepth practical.
